<!Doctype html>
<html lang="en">

<head>
	<title>Visualization</title>

	<!--meta-->
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="/favicons/ms-icon-144x144.png">
	<meta name="theme-color" content="#ffffff">
	<meta name="author" content="Dave Kwiatkowski">
	<meta name="description" content="Capital One Summit 2016">
	<meta name="keywords" content="Dave, Kwiatkowski, Capital, One, Summit, 2016, WebGL, Globe">

	<!--font-->
	<link href="https://fonts.googleapis.com/css?family=Karla" rel="stylesheet">

	<!--style-->
	<link rel="stylesheet" href="css/main.css" />

	<!--favicons-->
	<link rel="apple-touch-icon" sizes="57x57" href="/favicons/apple-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/favicons/apple-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/favicons/apple-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/favicons/apple-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/favicons/apple-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/favicons/apple-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/favicons/apple-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/favicons/apple-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="192x192" href="/favicons/android-icon-192x192.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="96x96" href="/favicons/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
	<link rel="manifest" href="/favicons/manifest.json">
</head>

<body>

		<div id="globe_container"></div>

  <!--scripts-->
		<script type="text/javascript" src="third-party/Three/Detector.js"></script>
		<script type="text/javascript" src="third-party/Three/three.min.js"></script>
		<script type="text/javascript" src="third-party/Three/Tween.js"></script>
		<script type="text/javascript" src="globe.js"></script>
		<script type="text/javascript">
    if (!Detector.webgl) {
  Detector.addGetWebGLMessage();
} else {
  var years = ['1990', '1995', '2000'];
  var container = document.getElementById('globe_container');
  var globe = new DAT.Globe(container);
  console.log(globe);
  var i, tweens = [];

  var settime = function (globe, t) {
    return function () {
      new TWEEN.Tween(globe).to({ time: t / years.length }, 500).easing(TWEEN.Easing.Cubic.EaseOut).start();
      var y = document.getElementById('year' + years[t]);
      if (y.getAttribute('class') === 'year active') {
        return;
      }
      var yy = document.getElementsByClassName('year');
      for (i = 0; i < yy.length; i++) {
        yy[i].setAttribute('class', 'year');
      }
      y.setAttribute('class', 'year active');
    };
  };

  for (var i = 0; i < years.length; i++) {
    var y = document.getElementById('year' + years[i]);
    y.addEventListener('mouseover', settime(globe, i), false);
  }

  var xhr;
  TWEEN.start();


  xhr = new XMLHttpRequest();
  xhr.open('GET', 'population909500.json', true);
  xhr.onreadystatechange = function (e) {
    if (xhr.readyState === 4) {
      if (xhr.status === 200) {
        var data = JSON.parse(xhr.responseText);
        window.data = data;
        for (i = 0; i < data.length; i++) {
          globe.addData(data[i][1], { format: 'magnitude', name: data[i][0], animated: true });
        }
        globe.createPoints();
        settime(globe, 0)();
        globe.animate();
        document.body.style.backgroundImage = 'none'; // remove loading
      }
    }
  };
  xhr.send(null);
}
    </script>
</body>

</html>